// ========================================
// Education & Experience Ribbon Data
// ========================================

const educationExperienceData = [
    // American University of Beirut
    {
        institution: 'American University of Beirut',
        degrees: [
            'Bachelor of Science (BSc)',
            'Master of Science (MSc)',
            'Doctor of Medicine (MD)'
        ],
        location: 'Beirut, Lebanon',
        image: 'https://www.aub.edu.lb/Communications/PublishingImages/AUB_Logo.jpg',
        backgroundLogo: 'https://www.genspark.ai/api/files/s/XdROh9g5'
    },
    // Johns Hopkins University
    {
        institution: 'Johns Hopkins University',
        degrees: [
            'Post-Doc Research Fellowship',
            'Clinical Trials Certificate'
        ],
        location: 'Baltimore, Maryland, USA',
        image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Johns_Hopkins_University_logo.svg/1200px-Johns_Hopkins_University_logo.svg.png',
        backgroundLogo: 'https://www.genspark.ai/api/files/s/CWdAzBF6'
    },
    // University of Toledo
    {
        institution: 'University of Toledo',
        degrees: [
            'General Surgery Residency'
        ],
        location: 'Toledo, Ohio, USA',
        image: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/58/Penn_State_Health_logo.svg/1200px-Penn_State_Health_logo.svg.png',
        backgroundLogo: 'https://www.genspark.ai/api/files/s/q2wCm7XU'
    },
    // United Arab Emirates University
    {
        institution: 'United Arab Emirates University',
        degrees: [
            'Adjunct Assistant Professor'
        ],
        department: 'Department of Surgery',
        location: 'Al Ain, Abu Dhabi, UAE',
        image: 'https://www.uaeu.ac.ae/images/default-source/default-album/uaeu_logo.jpg',
        backgroundLogo: 'https://www.genspark.ai/api/files/s/TBsO1sYy'
    }
];

// ========================================
// Honors Data
// ========================================

const honorsData = [
    {
        title: 'American College of Surgeons Travel Scholarship',
        organization: 'Leadership Conference and Advocacy Summit',
        location: 'Washington, DC, USA',
        description: 'Awarded for leadership excellence and advocacy in surgical education.',
        images: [
            'https://www.genspark.ai/api/files/s/YsSC3TGP',
            'https://www.genspark.ai/api/files/s/Jf2NiV0J'
        ]
    },
    {
        title: 'Best Resident Poster',
        organization: '94th Annual Conference of the American Association of Plastic Surgeons',
        location: 'Scottsdale, AZ, USA',
        description: 'Project: Functional abdominal wall reconstruction using an innervated abdominal wall vascularized composite allografts',
        images: [
            'https://www.genspark.ai/api/files/s/ismkR95f',
            'https://www.genspark.ai/api/files/s/DwT3CJ0G'
        ]
    },
    {
        title: 'Best Basic Science Paper',
        organization: '6th Annual Resident Research Symposium of the Johns Hopkins/University of Maryland Departments of Plastic Surgery',
        location: 'Baltimore, MD, USA',
        description: 'Project: Selectively permeable nanofiber construct for optimizing peripheral nerve repair',
        images: [
            'https://www.genspark.ai/api/files/s/dySgVOHv',
            'https://www.genspark.ai/api/files/s/WWnAwtgc'
        ]
    },
    {
        title: 'Best Research Poster',
        organization: '8th Annual Research Poster Session of the Johns Hopkins Department of Surgery',
        location: 'Baltimore, MD, USA',
        description: 'Project: Costimulatory Blockade in Combination with Donor Bone Marrow Infusion Induces Immune Tolerance Across a Full MHC Barrier in a Translational Large Animal Vascularized Composite Allotransplantation Model',
        images: [
            'https://www.genspark.ai/api/files/s/5aEeDP4d',
            'https://www.genspark.ai/api/files/s/jojVItkJ'
        ]
    },
    {
        title: 'Best Paper Award',
        organization: '59th Annual Conference of the Plastic Surgery Research Council',
        location: 'New York, NY, USA',
        description: 'Project: Immunosuppression-free Vascularized Composite Allotransplantation across a Full MHC Mismatch Using Cadaveric Bone Marrow Infusion and Costimulation Blockade in a Translational Large Animal Model',
        images: [
            'https://www.genspark.ai/api/files/s/zNPHDIni',
            'https://www.genspark.ai/api/files/s/YWw2TT6a'
        ]
    },
    {
        title: 'Best Paper Session',
        organization: '59th Annual Conference of the Plastic Surgery Research Council',
        location: 'New York, NY, USA',
        description: 'Project: Selectively Permeable Nanofiber Constructs to Prevent Inflammatory Scarring And Enhance Nerve Regeneration in Peripheral Nerve Injury',
        images: [
            'https://www.genspark.ai/api/files/s/zoGrN9lG',
            'https://www.genspark.ai/api/files/s/5FTUtYqE'
        ]
    },
    {
        title: 'Highest Podium Presentation Score',
        organization: '99th Annual Clinical Congress of the American College of Surgeons',
        location: 'Washington, DC, USA',
        description: 'Project: Building a Clinical Risk Model to Predict Morbidity after Breast Surgery',
        images: [
            'https://www.genspark.ai/api/files/s/lMzleInL',
            'https://www.genspark.ai/api/files/s/AXa00Y5I'
        ]
    },
    {
        title: 'Best Research Poster',
        organization: '7th Annual Research Poster Session of the Johns Hopkins Department of Surgery',
        location: 'Baltimore, Maryland, USA',
        description: 'Project: Combined Co-stimulatory Blockade and Donor Bone Marrow Cells Induce Robust Immune Tolerance in a Fully SLA-mismatched Swine Hind Limb Transplantation Model',
        images: [
            'https://www.genspark.ai/api/files/s/UVvS1P5c',
            'https://www.genspark.ai/api/files/s/xGRXCw9J'
        ]
    },
    {
        title: 'Resident Research Award',
        organization: 'Baltimore Academy of Surgery Research Day',
        location: 'Baltimore, Maryland, USA',
        description: 'Project: Combined Co-Stimulatory Blockade and Donor Bone Marrow Cells Induce Robust Immune Tolerance in a Fully SLA-mismatched Swine Hind Limb Transplantation Model',
        images: [
            'https://www.genspark.ai/api/files/s/yaXjs2ic',
            'https://www.genspark.ai/api/files/s/TINJZXK8'
        ]
    },
    {
        title: 'Best Poster Award',
        organization: '58th Annual Conference of the Plastic Surgery Research Council',
        location: 'Santa Monica, California, USA',
        description: 'Project: Cutaneous collateral axonal sprouting re-innervates the skin component and restores sensation of denervated swine osteomyocutaneous alloflaps',
        images: [
            'https://www.genspark.ai/api/files/s/xTMp6aak',
            'https://www.genspark.ai/api/files/s/MFiic362'
        ]
    },
    {
        title: 'Poster of Distinction',
        organization: 'American Transplant Congress',
        location: 'Seattle, Washington, USA',
        description: 'Project: Immune tolerance across a full MHC barrier in a swine hind limb transplantation model using a combined co-stimulatory blockade and donor bone marrow cell approach',
        images: [
            'https://www.genspark.ai/api/files/s/lSGexpwE',
            'https://www.genspark.ai/api/files/s/0LG2CIfZ'
        ]
    }
];

// ========================================
// National Presentations Data
// ========================================

const recognitionData = [
    {
        title: 'Tissue CLN3: A potential biomarker for breast cancer?',
        conference: '45th Middle East Medical Assembly (MEMA)',
        location: 'Beirut, Lebanon',
        date: 'May 2012',
        type: 'Podium Presentation'
    },
    {
        title: 'Preoperative anemia and postoperative outcomes in immediate breast reconstructive surgery: a critical analysis of 10,958 patients from the ACS-NSQIP database',
        conference: 'American Association of Plastic Surgeons (AAPS)',
        location: 'New Orleans, Louisiana, USA',
        date: 'Apr 2013',
        type: 'Poster Presentation'
    },
    {
        title: 'Health Related Quality of Life Associated with Oncologic Breast Reconstruction Surgery Interim Analysis',
        conference: 'American Society of Plastic Surgeons (ASPS)',
        location: 'San Diego, California, USA',
        date: 'Oct 2013',
        type: 'Podium Presentation'
    },
    {
        title: 'Vascularized Composite Allotransplantation: Laboratory Update',
        conference: 'Research Day at Johns Hopkins Department of Surgery',
        location: 'Baltimore, Maryland, USA',
        date: 'Nov 2013',
        type: 'Podium Presentation'
    },
    {
        title: 'Immunosuppression-free Vascularized Composite Allotransplantation using bone marrow cells & anti-CD154',
        conference: 'Plastic Surgery Research Council (PSRC)',
        location: 'Santa Monica, California, USA',
        date: 'May 2014',
        type: 'Podium Presentation'
    },
    {
        title: 'Costimulatory Blockade Induces Immune Tolerance in VCA Across Full MHC Mismatch',
        conference: 'Johns Hopkins Department of Surgery Research Day',
        location: 'Baltimore, Maryland, USA',
        date: 'Nov 2014',
        type: 'Podium Presentation'
    },
    {
        title: 'Combined Co-stimulatory Blockade and Donor Bone Marrow Cells Induce Robust Immune Tolerance in a Fully SLA-mismatched Swine Hind Limb Transplantation Model',
        conference: 'American Transplant Congress',
        location: 'Philadelphia, Pennsylvania, USA',
        date: 'May 2015',
        type: 'Poster Presentation'
    },
    {
        title: 'Bone marrow infusion and costimulation blockade induce immune tolerance in a fully MHC-mismatched swine hind limb transplant',
        conference: 'Johns Hopkins Department of Surgery Research Day',
        location: 'Baltimore, Maryland, USA',
        date: 'Nov 2015',
        type: 'Podium Presentation'
    },
    {
        title: 'Cutaneous collateral axonal sprouting re-innervates the skin component and restores sensation of denervated swine osteomyocutaneous alloflaps',
        conference: 'Plastic Surgery Research Council (PSRC)',
        location: 'New York, New York, USA',
        date: 'May 2016',
        type: 'Podium Presentation'
    },
    {
        title: 'A Tissue-Engineered Axonal Guidance Conduit for Peripheral Nerve Repair using Nanofibers',
        conference: 'Plastic Surgery Research Council (PSRC)',
        location: 'New York, New York, USA',
        date: 'May 2016',
        type: 'Podium Presentation'
    },
    {
        title: 'Nanofibers As a Selectively Permeable Conduit to Support Regeneration and Prevent Scarring in Peripheral Nerve Injury',
        conference: 'Johns Hopkins University/University of Maryland Plastic Surgery Research Symposium',
        location: 'Baltimore, Maryland, USA',
        date: 'May 2016',
        type: 'Podium Presentation'
    },
    {
        title: 'Building a Clinical Risk Model to Predict Morbidity after Breast Surgery',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'Washington, DC, USA',
        date: 'Oct 2016',
        type: 'Podium Presentation'
    },
    {
        title: 'Effects of Immunosuppression and Donor Bone Marrow Cell Mobilization on Skeletal Muscle Regeneration and Function in VCA',
        conference: 'American Transplant Congress',
        location: 'Seattle, Washington, USA',
        date: 'May 2017',
        type: 'Poster Presentation'
    },
    {
        title: 'Functional abdominal wall reconstruction using an innervated abdominal wall vascularized composite allografts',
        conference: 'American Association of Plastic Surgeons (AAPS)',
        location: 'Scottsdale, Arizona, USA',
        date: 'Apr 2018',
        type: 'Poster Presentation'
    },
    {
        title: 'Selectively permeable nanofiber construct for nerve repair and limb transplants',
        conference: 'American Society for Surgery of the Hand (ASSH)',
        location: 'Boston, Massachusetts, USA',
        date: 'Sep 2018',
        type: 'Poster Presentation'
    },
    {
        title: 'Novel Nanofiber Nerve Conduits for Upper Extremity Nerve Repair',
        conference: 'American Society for Surgery of the Hand (ASSH)',
        location: 'Boston, Massachusetts, USA',
        date: 'Sep 2018',
        type: 'Poster Presentation'
    },
    {
        title: 'Factors associated with postoperative wound infections and operative time in colorectal surgery',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'Boston, Massachusetts, USA',
        date: 'Oct 2018',
        type: 'Poster Presentation'
    },
    {
        title: 'Postoperative Outcomes in Patients with Cardiac Risk undergoing Elective General Surgery',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'Boston, Massachusetts, USA',
        date: 'Oct 2018',
        type: 'Poster Presentation'
    },
    {
        title: 'Risk of Blood Transfusion in Colon Surgery',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'Boston, Massachusetts, USA',
        date: 'Oct 2018',
        type: 'Poster Presentation'
    },
    {
        title: 'The impact of morbid obesity on inpatient outcomes for liver resection',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'Boston, Massachusetts, USA',
        date: 'Oct 2018',
        type: 'Poster Presentation'
    },
    {
        title: 'Multivariable analysis for the effect of anesthesia type on postoperative outcomes following pancreas resection',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'Boston, Massachusetts, USA',
        date: 'Oct 2018',
        type: 'Poster Presentation'
    },
    {
        title: 'A Critical Evaluation of Outcomes in Emergency Versus Elective General Surgery',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    },
    {
        title: 'Predicting Postoperative Complications in Elderly (â‰¥80yrs) Patients undergoing General Surgery',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    },
    {
        title: 'Prophylactic Drains Do Not Reduce Surgical Site Infections after Enterectomy',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    },
    {
        title: 'Risk Assessment for Postoperative Ileus after Proctectomy',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    },
    {
        title: 'Impact of Immunosuppression on Outcomes of Colon Resections',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    },
    {
        title: 'Postoperative Complications in Smokers Undergoing Hernia Repair',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    },
    {
        title: 'Effect of Prior Abdominal Surgery on Hernia Repair',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    },
    {
        title: 'Multivariable Analysis for the Effect of Anesthesia Type on Postoperative Complications Following Hernia Repair',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    },
    {
        title: 'A Critical Evaluation of Outcomes in Emergency Versus Elective Colon Surgery',
        conference: 'American College of Surgeons Clinical Congress',
        location: 'San Francisco, California, USA',
        date: 'Oct 2019',
        type: 'Poster Presentation'
    }
];

// ========================================
// Populate Education & Experience Ribbon
// ========================================

function populateEducationRibbon() {
    const ribbonTrack = document.querySelector('#educationRibbon .ribbon-track');
    if (!ribbonTrack) return;

    // Triple items for ultra-smooth infinite scroll
    const items = [...educationExperienceData, ...educationExperienceData, ...educationExperienceData];

    items.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'ribbon-item';
        
        // Add data attribute for background logo
        if (item.backgroundLogo) {
            div.setAttribute('data-bg-logo', item.backgroundLogo);
            div.style.setProperty('--bg-logo', `url('${item.backgroundLogo}')`);
        }
        
        // Add institution identifier for specific styling
        const institutionSlug = item.institution.toLowerCase().replace(/\s+/g, '-');
        div.setAttribute('data-institution', institutionSlug);
        
        // Build degrees HTML
        let degreesHTML = '';
        item.degrees.forEach(degree => {
            degreesHTML += `<h4>${degree}</h4>`;
        });
        
        // Build department HTML (italics, not bold)
        let departmentHTML = '';
        if (item.department) {
            departmentHTML = `<p class="ribbon-department"><em>${item.department}</em></p>`;
        }
        
        div.innerHTML = `
            <img src="${item.image}" alt="${item.institution}" class="ribbon-item-image" onerror="this.style.display='none'">
            <h3>${item.institution}</h3>
            ${degreesHTML}
            ${departmentHTML}
            <p class="ribbon-location">${item.location}</p>
        `;
        
        ribbonTrack.appendChild(div);
    });
}

// ========================================
// Populate Honors Ribbon
// ========================================

function populateHonorsRibbon() {
    const ribbonTrack = document.querySelector('#honorsRibbon .ribbon-track');
    if (!ribbonTrack) return;

    // Triple items for ultra-smooth infinite scroll
    const items = [...honorsData, ...honorsData, ...honorsData];

    items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'ribbon-item';
        
        // Add background logo if available (single image)
        if (item.image) {
            div.style.setProperty('--bg-logo', `url('${item.image}')`);
        }
        
        // Create location HTML if location exists
        const locationHTML = item.location ? `<p class="ribbon-location">${item.location}</p>` : '';
        
        // Create images HTML if multiple images exist (display at bottom)
        let imagesHTML = '';
        if (item.images && item.images.length > 0) {
            imagesHTML = '<div class="honor-images">';
            item.images.forEach(imgUrl => {
                imagesHTML += `<img src="${imgUrl}" alt="Honor image" class="honor-image">`;
            });
            imagesHTML += '</div>';
        }
        
        div.innerHTML = `
            <h3>${item.title}</h3>
            <h4>${item.organization}</h4>
            ${locationHTML}
            <p>${item.description}</p>
            ${imagesHTML}
        `;
        ribbonTrack.appendChild(div);
    });
}

// ========================================
// Populate National Presentations Ribbon
// ========================================

function populateRecognition() {
    const ribbonTrack = document.querySelector('#recognitionRibbon .ribbon-track');
    if (!ribbonTrack) return;

    // Triple items for ultra-smooth infinite scroll
    const items = [...recognitionData, ...recognitionData, ...recognitionData];

    items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'ribbon-item';
        
        div.innerHTML = `
            <div class="presentation-type">${item.type}</div>
            <h3>${item.title}</h3>
            <h4>${item.conference}</h4>
            <p class="ribbon-location">${item.location}</p>
        `;
        ribbonTrack.appendChild(div);
    });
}

// ========================================
// Ribbon Auto-Scroll and Drag Functionality
// ========================================

function setupRibbonDrag(ribbonId) {
    const ribbon = document.getElementById(ribbonId);
    if (!ribbon) return;

    const track = ribbon.querySelector('.ribbon-track');
    let isDown = false;
    let startX;
    let scrollLeft;
    let autoScrollInterval;
    let isHovering = false;

    // Auto-scroll function
    function startAutoScroll() {
        if (autoScrollInterval) return;
        
        autoScrollInterval = setInterval(() => {
            if (!isDown && !isHovering) {
                ribbon.scrollLeft += 1;
                
                // Calculate the width of a single set of items (we have 3 sets)
                const singleSetWidth = ribbon.scrollWidth / 3;
                
                // When we've scrolled through one complete set, smoothly reset
                if (ribbon.scrollLeft >= singleSetWidth) {
                    // Temporarily disable smooth scroll for instant reset
                    ribbon.style.scrollBehavior = 'auto';
                    ribbon.scrollLeft = 0;
                    // Re-enable smooth scroll after reset
                    setTimeout(() => {
                        ribbon.style.scrollBehavior = 'smooth';
                    }, 0);
                }
            }
        }, 20);
    }

    function stopAutoScroll() {
        if (autoScrollInterval) {
            clearInterval(autoScrollInterval);
            autoScrollInterval = null;
        }
    }

    // Drag functionality
    ribbon.addEventListener('mousedown', (e) => {
        isDown = true;
        ribbon.style.cursor = 'grabbing';
        ribbon.classList.add('paused');
        startX = e.pageX - ribbon.offsetLeft;
        scrollLeft = ribbon.scrollLeft;
    });

    ribbon.addEventListener('mouseleave', () => {
        isDown = false;
        isHovering = false;
        ribbon.style.cursor = 'grab';
        ribbon.classList.remove('paused');
    });

    ribbon.addEventListener('mouseup', () => {
        isDown = false;
        ribbon.style.cursor = 'grab';
        ribbon.classList.remove('paused');
    });

    ribbon.addEventListener('mousemove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - ribbon.offsetLeft;
        const walk = (x - startX) * 2;
        ribbon.scrollLeft = scrollLeft - walk;
    });

    // Pause on hover
    ribbon.addEventListener('mouseenter', () => {
        isHovering = true;
        ribbon.classList.add('paused');
    });

    ribbon.addEventListener('mouseleave', () => {
        isHovering = false;
        ribbon.classList.remove('paused');
    });

    // Set initial cursor and start auto-scroll
    ribbon.style.cursor = 'grab';
    startAutoScroll();
}

// ========================================
// Initialize on Page Load
// ========================================

document.addEventListener('DOMContentLoaded', () => {
    populateEducationRibbon();
    populateHonorsRibbon();
    populateRecognition();
    
    setupRibbonDrag('educationRibbon');
    setupRibbonDrag('honorsRibbon');
    setupRibbonDrag('recognitionRibbon');
});
